\documentclass[openany, 11pt]{book}

% ============== PACKAGES ==============
\usepackage{graphicx}       % For including images
\usepackage{fancyhdr}       % For customizing headers and footers
\usepackage{titlesec}       % For formatting section and chapter titles
\usepackage{textcase}       % For text case transformations
\usepackage{ulem}           % For underlining and strikeout text
\usepackage{tcolorbox}      % For creating colored/text-boxes
\usepackage{courier}        % For using Courier as a font
\usepackage[margin=2.5cm, top=2cm]{geometry} % Set general page margins
\usepackage{background}     % For adding a background box on each page
\usepackage{etoolbox}       % For resetting counters
\usepackage[ngerman, english, dutch]{babel}
\usepackage{iflang}

% ============ GENERAL SETTINGS ============
\renewcommand{\rmdefault}{pcr} % Set Courier as the default font family
\graphicspath{{./}{./images/}} % Define paths for images

% ============ PAGE NUMBERING ============
\makeatletter
\renewcommand{\thepage}{%
  \thechapter.%                % Include the chapter number
  \ifnum\c@section<10 0\fi%    % Add leading zero to single-digit section numbers
  \@arabic\c@section-%         % Render section number
  \arabic{page}%               % Render the page number
}
\makeatother

% Reset section page numbers per chapter
\newcounter{sectioninchapter}
\pretocmd{\chapter}{\setcounter{sectioninchapter}{0}}{}{}
\pretocmd{\section}{%
  \ifnum\value{sectioninchapter}=0
    \setcounter{page}{1}
  \else
    \clearpage\setcounter{page}{1}
  \fi
  \stepcounter{sectioninchapter}
}{}{}

% ============= HEADER CONFIG =============
\setlength{\topmargin}{-2cm}      % Move content block closer to the top
\setlength{\headheight}{33pt}     % Increase header height to fit the logo
\setlength{\headsep}{10pt}        % Space between the header and content

\pagestyle{fancy}
\fancyhf{} % Clear default header/footer content
\fancyhead[L]{\includegraphics[height=1cm]{maho-logo.png}} % Add logo on the left
\fancyhead[C]{\raisebox{1.2\height}{\textbf{MH 400 E}}}    % Add centered header text
\fancyhead[R]{\raisebox{1.2\height}{\textbf{\thepage}}}    % Add page number on the right
\renewcommand{\headrulewidth}{0pt} % Remove header rule line

% Header for chapter title pages
\fancypagestyle{plain}{%
  \fancyhf{}
  \fancyhead[L]{\includegraphics[height=1cm]{maho-logo.png}}
  \fancyhead[C]{\raisebox{1.2\height}{\textbf{MH 400 E}}}
  \fancyhead[R]{\raisebox{1.2\height}{\textbf{\thepage}}}
}

% ========== BACKGROUND CONFIG ==========
\backgroundsetup{%
  scale=1,
  color=black,
  opacity=1,
  angle=0,
  position=current page.south west,
  vshift=1cm,
  hshift=2cm,
  nodeanchor=south west,
  contents={%
    \begin{tikzpicture}[remember picture, overlay]
      \node[anchor=south west, inner sep=0] (box) at (0, 0) {
        \begin{tcolorbox}[
          colframe=black, 
          colback=white, 
          boxrule=0.5mm,
          sharp corners, 
          width=\dimexpr\paperwidth-3cm\relax,
          height=\dimexpr\paperheight-3cm\relax
        ]
        \end{tcolorbox}
      };
      \draw[black, thick] ([yshift=1cm]box.south west) -- ([yshift=1cm]box.south east);
      \node[anchor=south, yshift=-.6cm] at ([yshift=1cm]box.south) {
        \footnotesize \textit{MAHO WERKZEUGMACHINENBAU BABEL \& CO. D-8962 FRONTEN}
      };
    \end{tikzpicture}
  }
}

% ========== CHAPTER FORMATTING ==========
\titleformat{\chapter}[block]{\normalfont\Large\bfseries}{}{0pt}{\chapterTitleStyle}
\titlespacing*{\chapter}{0pt}{0pt}{20pt}
\newcommand{\chapterTitleStyle}[1]{%
  \vspace{-1em}
  \underline{\MakeUppercase{#1}}
  \vspace{1em}
}

% ========== SECTION FORMATTING ==========
\titleformat{\section}[block]{\normalfont\large\bfseries}{}{0pt}{\sectionTitleStyle}
\titlespacing*{\section}{0pt}{10pt}{10pt}
\newcommand{\sectionTitleStyle}[1]{%
  \underline{\MakeUppercase{#1}}
}

% ======== SUBSECTION FORMATTING =========
\titleformat{\subsection}[block]{\normalfont\normalsize\bfseries}{}{0pt}{}
\titlespacing*{\subsection}{0pt}{10pt}{10pt}

% Define commands for easier switching
\newcommand{\DE}[1]{\foreignlanguage{ngerman}{#1}} % Short for German
\newcommand{\EN}[1]{\foreignlanguage{english}{#1}} % Short for English
\newcommand{\NL}[1]{\foreignlanguage{dutch}{#1}}   % Short for Dutch

% =========== DOCUMENT CONTENT ===========
\begin{document}

% Example content
\IfLanguageName{ngerman}{
  \chapter{Einleitung}
  Dies ist das deutsche Handbuch.

  \chapter{Kapitel 1}
  Maschineninformationen auf Deutsch.
}

% English Section
\IfLanguageName{english}{
  \chapter{Introduction}
  This is the English manual.

  \chapter{Chapter 1}
  Machine information in English.
}

% Dutch Section
\IfLanguageName{dutch}{
  \chapter{Inleiding}
  Dit is de Nederlandse handleiding.

  \chapter{Hoofdstuk 1}
  Machine-informatie in het Nederlands.
}

\end{document}